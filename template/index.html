<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/hje.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans">
    <title>Template</title>
</head>

<body>

    <nav class="navbar">
        <ul class="navbar-nav">
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="tshirt"
                        class="svg-inline--fa fa-tshirt fa-w-20" role="img" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 640 512">
                        <path fill="currentColor"
                            d="M631.2 96.5L436.5 0C416.4 27.8 371.9 47.2 320 47.2S223.6 27.8 203.5 0L8.8 96.5c-7.9 4-11.1 13.6-7.2 21.5l57.2 114.5c4 7.9 13.6 11.1 21.5 7.2l56.6-27.7c10.6-5.2 23 2.5 23 14.4V480c0 17.7 14.3 32 32 32h256c17.7 0 32-14.3 32-32V226.3c0-11.8 12.4-19.6 23-14.4l56.6 27.7c7.9 4 17.5.8 21.5-7.2L638.3 118c4-7.9.8-17.6-7.1-21.5z">
                        </path>
                    </svg>
                    <span class="link-text">SHOP</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="calendar"
                        class="svg-inline--fa fa-calendar fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 448 512">
                        <path fill="currentColor"
                            d="M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z">
                        </path>
                    </svg>
                    <span class="link-text">TODOS</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link">
                    <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home"
                        class="svg-inline--fa fa-home fa-w-18" role="img" xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 576 512">
                        <path fill="currentColor"
                            d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z">
                        </path>
                    </svg>
                    <span class="link-text">HOME</span>
                </a>
            </li>
        </ul>
    </nav>

    <main>
        <!-- style="display: block;" -->
        <div id="home" class="show">
            This is home.
        </div>

        <div id="shop" class="hide"></div>
        <div id="todos" class="hide">
            <form id="todo-form">
                <input type="text" maxlength="15" placeholder="Please write what to do" required>
                <!-- <input type="submit" value="submit"> -->
                <button>Regist</button>
            </form>
            <ul id="todo-list" class="hidden"></ul>
            
            <script>
                const head = document.getElementsByTagName("head")[0];
            
                // 1. css
                const cssRef = document.createElement('link');
                cssRef.rel = 'stylesheet';
                cssRef.type = 'text/css';
                cssRef.href = '../week01/css/todoList2.css';
                head.appendChild(cssRef);
            
                // 2. js
                const jsRef = document.createElement('script');
                jsRef.type = 'text/javascript';
                jsRef.src = '../week01/js/todoList2.js';
                head.appendChild(jsRef);
            </script>
        </div>
    </main>

    <script>
        const HIDE_CLASS = 'hide';
        const SHOW_CLASS = 'show';

        const onClickFn = function onClickFn(event) {
            // issue: 그대로 사용 시 이미지 클릭 시 텍스트 추출 불가
            console.log(event.target);

            // tag: SPAN, A, path
            let content;
            const eTarget = event.target;
            const clickedTag = eTarget.tagName.toLowerCase();
            if (clickedTag === 'span') {
                content = eTarget.innerText.toLowerCase();
            } else if (clickedTag === 'a') {
                content = eTarget.querySelector('span').innerText.toLowerCase();
            } else { // clickedTag === path
                content = eTarget.parentNode.parentNode.querySelector('span').innerText.toLowerCase();
            }
            console.log(content);

            // add content dynamically
            addContent(content);

            // show/hide div dynamically
            changeDiv(content);
        }

        const addContent = function addContent(content) {
            const clickedDiv = document.getElementById(content);
            console.log(clickedDiv);

            // issue: fileReader 미존재 시
            let htmlText = 'file:///C:/Users/NT930QAA/Desktop/vallina/week01/' + content + '.html';
            readTextFile(htmlText);
        }

        const changeDiv = function changeDiv(content) {
            // issue: source tab에서 확인 불가
            // hide all
            document.querySelectorAll('div').forEach(elem => {
                elem.classList.remove(SHOW_CLASS);
                elem.classList.add(HIDE_CLASS);
            });

            // show clicked one
            let clickedDiv = document.getElementById(content);
            console.log(clickedDiv);
            clickedDiv.classList.add(SHOW_CLASS);
        }

        document.querySelectorAll('a').forEach(elm => {
            elm.addEventListener('click', onClickFn);
        });

        // when webserver is running
        function readTextFile(file) {
            var rawFile = new XMLHttpRequest();
            rawFile.open("GET", file, false);
            rawFile.onreadystatechange = function () {
                if (rawFile.readyState === 4) {
                    if (rawFile.status === 200 || rawFile.status == 0) {
                        var allText = rawFile.responseText;
                        alert(allText);
                    }
                }
            }
            rawFile.send(null);
        }

    </script>
</body>

</html>